pico-8 cartridge // http://www.pico-8.com
version 41
__lua__

--to do--
--art--
--blackjack rules/mechanics--
--dealing mechanics--
--animations--
--result screens--
--money(?)--

--suit value--
	
 total_score={1}

 dealt_card = false

	clubs = 2
 spades = 3
 diamonds = 4
	hearts = 5

function initdeck()
 deck = {}
 idx = 1
  for i = clubs, hearts do
   for j = 1,13 do
    deck[idx] = {v = j, t = i}
    idx = idx + 1
   end
  end
  for i=52,2,-1 do
   j = flr(rnd(i)+1)
   t = deck[i]
   deck[i] = deck[j]
   deck[j] = t
  end
  playerhand = {}
  dealerhand = {}
  playerturn = true
end

function _init()
	mode="start_screen"
end

function update_start()
 if btnp(❎) and mode == "start_screen" then
  mode="game"
  cls(3)
 end
end

function update_gameover()
 if btnp(❎) and mode == "game_over" then
  mode = "start_screen"
 end
end

function _update60()
 if mode == "start_screen" then
  draw_start()
  update_start()
 elseif mode == "game" then
  draw_game()
  startgame()
  points()
 elseif mode == "game_over" then
  draw_gameover()
 end
end

function startgame()
 dealt_card = false
 if btnp(❎) and mode == "game" then
  initdeck()
  draw_card()
  dealt_card = true
  add(total_score,deck[1].v)
 end
end

function draw_card()

 -- convert suit --
 if deck[1].t == 2 then
   deck[1].t = "clubs"
 else if deck[1].t == 3 then
   deck[1].t = "spades"
 else if deck[1].t == 4 then
   deck[1].t = "diamonds"
 else
   deck[1].t = "hearts" 
 end
 end
 end

 cls(3)
 print("player card 1: ",5,110,7)
 print(deck[1].v .. " of " .. deck[1].t, 5, 118, 7)
end

function points()

 local sum = -1

 for i = 1, #total_score do

  sum = sum + total_score[i]

  if sum > 21 then
   mode = "game_over"
  end

 end

 print(sum,5,5,7)
end

function draw_start()
 cls(3)
 map(16,16)
 map(0,0,0,0,16,16)
 print("press ❎ to start",31,60,7)
end

function draw_game()
 print("press ❎ to hit",36,60,7)
 print(mode,50,5,7)
end

function draw_gameover()
 cls(3)
 print("game over",40,60,7)
end

__gfx__
00000000007777003333333333333333333333333333333300000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000078877703333333333333333333333333333333300000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700077877703333337777377337777377773773733300000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000077877703333307707077307707077070770733300000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000078887703333307707077307707077330777333300000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700077777703333307777077307777077330777733300000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000077777703333307707077307707077070770733300000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000007777003333307777077707707077770770733300000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000003333300003000300030000030003033300000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000003333333333333333333333333333333300000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000003333333333337737777377773773733300000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000003333333333307707707077070770733300000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000003333333333307707707077330777333300000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000087887333333307707777077330777733300000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000087887333333707707707077070770733300000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000055555333330777707707077770770733300000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000078878333330003300030000030033033300000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000078878333333333333333333333333333300000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000005555530aaaa30aa33333333308333333300000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000008788730a000300033333333308333333300000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000008788730a0a0aaa099309903888088833300000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000005555530aa0a30a090909080808080033300000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000007887830a00a30a099009080808808333300000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000007887800a00a30aa09999088088088833300000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000055555033333333333333333333333333300000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000087887033333333333333333333333333300000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000008788707aa7a333333333333333333333300000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000005555507aa7a333333333333333333333300000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000078878055555333333333333333333333300000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000788780a7aa7333333333333333333333300000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000555550a7aa7333333333333333333333300000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000088788055555333333333333333333333300000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0203040500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1213040500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2223242500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3233343500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
